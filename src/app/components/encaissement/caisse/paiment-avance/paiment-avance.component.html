<div class="content-wrapper" xmlns="http://www.w3.org/1999/html">
  <div class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1 class="m-0">Paiement en Avance </h1>
        </div>

        <div class="col-sm-6">
          <ol class="breadcrumb float-sm-right">
            <li class="breadcrumb-item"><a routerLink="/encaissement/dashboard">Home</a></li>
            <li class="breadcrumb-item active">Paiement Avance</li>
          </ol>
        </div>
      </div>
    </div>
  </div>

  <div class="content">
    <div class="container-fluid">
      <div class="row col-12">
        <div class="col-12 table-responsive" style="height: 300px;">
          <table class="table table-hover table-striped table-head-fixed">
            <thead>
            <tr>
              <th>Reference</th>
              <th>ID Client</th>
              <th>Produit</th>
              <th>N° Téléphone</th>
              <th> Pourcentage Payé (%)</th>
              <th>Date Limite</th>
              <th>Montant</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let facture of listFacture" (dblclick)="selectFacture(facture)"
                [class.bg-gradient-lightblue]="facture.idFacture ===factureSelected?.idFacture"
                [style.cursor]="'pointer'">
              <td><span
                class="flex justify-content-around mr-5 text-bold">{{facture.refFacture}}</span>
              </td>
              <td><span class="flex justify-content-sm-center mr-5 ">{{facture.identifiant}}</span>
              <td><span class="flex justify-content-sm-start mr-5 ">{{facture.produit | titlecase}}</span>
              </td>
              <td>
                <ng-container>
                  <i class="fas fa-phone"></i> {{ facture.nappel }}
                </ng-container>

              </td>
              <td>
                <p-progressBar *ngIf="getProgressBarColor(calculPercent(facture))==='orange'"
                               [style]="{ height: '15px',width:'160px'}" [showValue]="true"
                               color="orange"
                               [value]='calculPercent(facture)'></p-progressBar>
                <p-progressBar *ngIf="getProgressBarColor(calculPercent(facture))==='purple'"
                               [style]="{ height: '15px',width:'160px'}" [showValue]="true"
                               color="#078fa1"
                               [value]='calculPercent(facture)'></p-progressBar>
                <p-progressBar *ngIf="getProgressBarColor(calculPercent(facture))==='green'"
                               [style]="{ height: '15px',width:'160px'}" [showValue]="true"
                               color="#119b11"
                               [value]='calculPercent(facture)'></p-progressBar>
              </td>


              <td><span class="flex justify-content-sm-start ">{{facture.datLimPai |date: 'MM/dd/yyyy' }}</span>
              </td>


              <td><span class="flex justify-content-around  text-bold"> {{facture.montant | number: '1.3-3'}} <small> TND</small></span>
              </td>

            </tr>
            </tbody>
          </table>
        </div>
      </div>


      <div class="row">
        <div class="col-sm-11 mx-auto">
          <div class="card card-default border-round-2xl shadow-6">


            <div class="card-body">
              <button class=" float-right mr-3 btn btn-sm col-sm-1 text-gray-900 bg-yellow-500  border-round"
                      (click)="resetSelection()"><i
                class="fa-solid fa-eraser"></i> Clear
              </button>

              <div class="text-center ml-6">
                <a class="h3 text-blue-800 ">Effectuer un Paiement</a>
              </div>

              <div class="row mt-6">
                <div class="col-sm-3  ">
                  <strong>- Reference:</strong>

                  <span class="ml-2"> {{ factureSelected?.refFacture }}

                </span></div>
                <div class="col-sm-3  ">
                  <strong>- Produit:</strong>
                  <span class="ml-2"> {{ factureSelected?.produit }}</span>
                </div>
                <div class="col-sm-3  ">
                  <strong>- Compte:</strong>
                  <span class="ml-2"> {{ factureSelected?.compteFacturation }}
                </span></div>
                <div class="col-sm-3  ">
                  <strong>- Téléphone:</strong>
                  <span class="ml-2">  {{ factureSelected?.nappel }}
                </span></div>
              </div>

              <div class="row mt-4">
                <div class="col-sm-3">
                  <strong>- ID Client:</strong>
                  <span class="ml-3"> {{ factureSelected?.identifiant }}
                </span></div>
                <div class="col-sm-3">
                  <strong>- Type:</strong>
                  <span class="ml-3">{{ factureSelected?.typeIdent }}
                </span></div>
                <div class="col-sm-3">
                  <span class="ml-3"><strong>- Code Client:</strong>
                    {{ factureSelected?.codeClient }}
                </span></div>
              </div>


              <div class="mx-auto col-sm-11 border-2 border-blue-700  mt-4 " style="background-color: aliceblue">
                <div class="row justify-content-end mt-2 mb-3">
                  <div class="col-sm-3">
                    <strong>Date Limite:</strong>
                    {{ factureSelected?.datLimPai }}
                  </div>
                  <div class="col-sm-3">
                    <strong>Remise (%):</strong>
                    {{ factureSelected?.solde }} %
                  </div>
                  <div class="col-sm-3">
                    <strong>Montant : </strong>
                    <span class="text-bold">{{ factureSelected?.montant | number: '1.3-3' }}</span> TND
                  </div>
                </div>
              </div>
              <br>
              <div class="row">
                <div class="col-8"></div>
                <div class="col-3  ">
                  <div class="row  "><h4><i class="fa-solid fa-scroll"></i> - Journal de Paiement</h4></div>
                  <br>
                  <div class="" style="height: 300px;">
                    <p-timeline [value]="factureSelected?.encaissements || []" >
                      <ng-template pTemplate="marker" let-encaiss>
                        <span class="custom-marker " >
                           <i class="fas fa-check-circle text-green-600"></i>
                        </span>
                      </ng-template>
                      <ng-template pTemplate="content" let-encaiss>
                        <small class="p-text-secondary">{{ encaiss.dateEnc }}</small>
                      </ng-template>
                      <ng-template pTemplate="opposite" let-encaiss>
                        {{ encaiss.modePaiement | titlecase}}
                      </ng-template>
                    </p-timeline>
                  </div>
                </div>

              </div>
            </div>

          </div>


        </div>
      </div>
    </div>
  </div>
</div>
